var n=i=>{let t=history[i];return function(){let r=t.apply(this,arguments),e=new Event(i);return window.dispatchEvent(e),r}};var a=class{constructor(t){this.options=Object.assign(this.initOptions(),t),this.installLogger()}initOptions(){return window.history.pushState=n("pushState"),window.history.replaceState=n("replaceState"),{historyLogger:!1,hashLogger:!1,jsErrorLogger:!1,SDKVersion:"1.0.0",payload:{}}}instanllListerner(t,r,e){t.forEach(o=>{window.addEventListener(o,()=>{console.log("listener called"),this.reportTracker({event:o,targetKey:r,payload:e})})})}sendLogger(t){this.reportTracker(t)}setUserId(t){this.options.id=t}installErrorListerner(t,r){window.addEventListener("error",e=>{this.reportTracker({event:"js_error",targetKey:t||"JSerror",errorInfo:{message:e.message,lineno:e.lineno,scriptURI:e.filename,type:e.type}})}),window.onerror=function(e,o,s,l){console.error(`Error: ${e} at ${o}:${s}:${l}`)},window.addEventListener("unhandledrejection",e=>{e.promise.catch(o=>{this.reportTracker({event:"promise_unhandledrejectio",targetKey:r||"unhandledrejection",errorInfo:{type:e.reason}})})})}installDomLogger(t,r,e,o){r.forEach(s=>{t.addEventListener(s,()=>{typeof e=="string"?this.reportTracker({event:s,targetKey:e,payload:o}):this.reportTracker({event:s,targetKey:e[s],payload:o})})})}installLogger(){this.options.historyLogger&&this.instanllListerner(["pushState","replaceState","popState"],this.options.historyTargetK||"historyLogger"),this.options.hashLogger&&this.instanllListerner(["hashchange"],this.options.hashTargetKet||"hashLogger"),this.options.jsErrorLogger&&this.installErrorListerner()}reportTracker(t){let r=Object.assign(this.options,t,{time:new Date().getTime()}),e=new Blob([JSON.stringify(r)],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(this.options.requestUrl,e)}},p=a;var T=p;export{T as default};
