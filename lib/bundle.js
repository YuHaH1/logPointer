var i=n=>{let r=history[n];return function(){let t=r.apply(this,arguments),e=new Event(n);return window.dispatchEvent(e),t}};var a=class{constructor(r){this.options=Object.assign(this.initOptions(),r),this.installLogger()}initOptions(){return window.history.pushState=i("pushState"),window.history.replaceState=i("replaceState"),{historyLogger:!1,hashLogger:!1,jsErrorLogger:!1,SDKVersion:"1.0.0",payload:{}}}instanllListerner(r,t,e){r.forEach(o=>{window.addEventListener(o,()=>{console.log("listener called"),this.reportTracker({event:o,targetKey:t,payload:e})})})}sendLogger(r){this.reportTracker(r)}setUserId(r){this.options.id=r}installErrorListerner(r,t){window.addEventListener("error",e=>{this.reportTracker({event:"js_error",targetKey:r||"JSerror",errorInfo:{message:e.message,lineno:e.lineno,scriptURI:e.filename,type:e.type}})}),window.onerror=function(e,o,s,g){console.error(`Error: ${e} at ${o}:${s}:${g}`)},window.addEventListener("unhandledrejection",e=>{e.promise.catch(o=>{this.reportTracker({event:"promise_unhandledrejectio",targetKey:t||"unhandledrejection",errorInfo:{type:e.reason}})})})}installDomLogger(r,t,e,o){t.forEach(s=>{r.addEventListener(s,()=>{typeof e=="string"?this.reportTracker({event:s,targetKey:e,payload:o}):this.reportTracker({event:s,targetKey:e[s],payload:o})})})}installLogger(){this.options.historyLogger&&this.instanllListerner(["pushState","replaceState","popState"],"historyLogger"),this.options.hashLogger&&this.instanllListerner(["hashchange"],"hashLogger"),this.options.jsErrorLogger&&this.installErrorListerner()}reportTracker(r){let t=Object.assign(this.options,r,{time:new Date().getTime()}),e=new Blob([JSON.stringify(t)],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(this.options.requestUrl,e)}},p=a;var u=p;export{u as default};
